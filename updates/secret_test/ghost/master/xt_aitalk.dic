AiTalk
{
	if RAND(100) < communicateratio
 	{
 		StartCommunicate
	}
 	else
	{
 		if mikireflag == 0
		{
			if CHAIN.IDName == ""
			{
 				lastTalk = RandomTalk
			}
			else
			{
				lastTalk = ChainTalk
			}
			lastTalk
		}
 		else
		{ 
			MikireTalk
 		}
	}
}

//This is all the random dialogue your ghost will say on its own. nonoverlap here means all pieces of available dialogue will be said before it begins repeating dialogue. Note that if you have ifs in your dialogue, they reset the nonoverlap if they change from true to false or vice versa.
RandomTalk : nonoverlap
{
	"\0\s[0]All your random dialogue goes here!\e"
	"\0\s[0]Here's a chain!\e:chain=achain"
	"\0\s[0]Today is %(nowday)!\e"
	
	
	
	//User Environment Ifs - Use as many of these as you like for dynamic dialogue
	//---Timeslots---
	if timeslot == "earlymorning" //5am - 8am
	{
		if runtime[0] > 3 //Been open for 3 hours or more, so the user has probably been up all night
		{
			
		}
		else //Just got up
		{
			
		}
	}
	if timeslot == "morning" //9am - 11am
	{
		
	}
	if timeslot == "lunch" //12pm - 2pm
	{
		
	}
	if timeslot == "afternoon" //3pm - 5pm
	{
		
	}
	if timeslot == "evening" //6pm - 8pm
	{
		
	}
	if timeslot == "latenight" //9pm - 12am
	{
		
	}
	if timeslot == "midnight" //1am - 4am
	{
		
	}
	
	//---Days of the week---
	if wd == "Sun"
	{
		
	}
	if wd == "Mon"
	{
		
	}
	if wd == "Tue"
	{
		
	}
	if wd == "Wed"
	{
		
	}
	if wd == "Thu"
	{
		
	}
	if wd == "Fri"
	{
		
	}
	if wd == "Sat"
	{
		
	}
	
	//---Days in the month---
	if day < 5 //4th and before, start of the month
	{
		
	}
	if day > 13 && day < 17 //14th-16th, halfway through
	{
		
	}
	if day > 26 //27th and after, end of the month
	{
		
	}
	
	//---Months---
	if month == 1
	{
		
	}
	if month == 2
	{
		
	}
	if month == 3 //Spring start Northern, Autumn start Southern
	{
		
	}
	if month == 4
	{
		
	}
	if month == 5
	{
		
	}
	if month == 6 //Summer start Northern, Winter start Southern
	{
		
	}
	if month == 7
	{
		
	}
	if month == 8
	{
		
	}
	if month == 9 //Autumn start Northern, Spring start Southern
	{
		
	}
	if month == 10
	{
		
	}
	if month == 11
	{
		
	}
	if month == 12 //Winter start Northern, Summer start Southern
	{
		
	}
	
	//---Seasons---
	if season == "Spring"
	{
		
	}
	if season == "Summer"
	{
		
	}
	if season == "Autumn"
	{
		
	}
	if season == "Winter"
	{
		
	}
	
	
	//---Noticing and commenting on other ghosts. You MUST have an option for 'others' in the case/when, or the ghost will eventually stop talking at all! I've set it up to loop back around to aitalk, but you can put generic dialogue if you like.
	if ghostexcount > 0 //Based on code from Zarla's Gaster
	{
		_number = RAND(ghostexcount) //This checks the number of other ghosts summoned and chooses a random number based on it
		--
		randghostname = "%(ghostexlist[_number])" //This grabs the reference name of the ghost to check against known names.
		--
		//This will tell you the reference names of your summoned ghosts to use in the "when" cases below, along with the number of ghosts.
		//Comment it out when you no longer need it for reference.
		//"\0\s[0]Ghost List: %(ghostexlist)\n\n[half]Noticed %(randghostname), %(_number) of %(ghostexcount)\x"
		--
		// Checking the selected loaded ghost's name vs known names to comment on them
		case randghostname
		{
			when "Girl"
			{
				"\0\s[0]Another template ghost!\w8\w8 Hi Girl!\e"
			}
			others //This is necessary. If you want them to comment on other ghosts generically you can, but if not this will just loop back around to aitalk so they don't get stuck
			{
				"\![raise,OnAiTalk]"
			}
		}
	}
}


//-----------Chains-----------

//Example of a chain. The dialogues will play in order each time the ghost talks until it reaches chain=end.
achain
{{CHAIN
	"\0\s[0]Here's another part of the chain!\e"
	"\0\s[0]Here's a third part of the chain!\e"
	"\0\s[0]Here's a fourth part of the chain!\e"
	"\0\s[0]Here's the end of a chain!\e:chain=end"
}}CHAIN


//-----------Timekeeping systems and related dialogue-----------

OnMinuteChange
{
	if minute == 0 //Top of the hour notifications
	{
		if hour == 0
		{
			AutoUpdateCheck = 0
			if day == 1 && month == 1
			{
				"\0\s[0]Happy new year!\e"
			}
			else
			{
				"\0\s[0]It's midnight.\e"
			}
		}
		elseif hour == 12
		{
			"\0\s[0]It's noon.\e"
		}
		else
		{
			"\0\s[0]It's %(hour12)'o clock.\e"
		}
	}
	elseif mikireflag == 1 //If the ghost is off the screen, it will run the off screen dialogue every minute
 	{
 		MikireTalk
	}
	--
	if AutoUpdate == "On" && AutoUpdateCheck == 0 //Once a day the ghost will check for updates if the user has auto updates on
	{
		AutoUpdateCheck = 1
		"\![updatebymyself,checkonly]"
	}
	
}

OnSecondChange
{
	if runtime[2] >= 59
	{
		runtime[2] = 0
		runtime[1]++
		if runtime[1] >= 59
		{
			runtime[1] = 0
			runtime[0]++
		}
	}
	else
	{
		runtime[2]++
		totalhours++
	}
	if mikireflag == 0 && reference1 == 1 //Dialogue for putting them off the screen. You could make this a unique line if you wanted, and have MikireTalk be for if they continue to be offscreen
	{
		MikireTalk
	}
	if mikireflag == 1 && reference1 == 0 //Dialogue for coming back on the screen
	{
		EndMikireTalk
	}
	mikireflag = reference1 //reference1 is if the ghost is offscreen or not
	if reference2 == 1 //This is for if your Sakura and Kero are overlapping. \4 will move the speaking character away from the other character.
	{
		"\0\s[0]Me and %(keroname) are overlapping.\4\e"
	}
}

MikireTalk //Off the screen dialogue. Ctrl Shift F12 will bring characters back onto the screen
{
	"\0\s[0]I'm off the screen.\w8\w8 You can press Ctrl Shift F12 to bring me back.\e"
}

EndMikireTalk //Being brought back on the screen.
{
	"\0\s[0]I'm back!\e"
}

OnSurfaceRestore //OnSurfaceRestore happens around 30 seconds after the ghost's last dialogue. reference0 here stores the number of the previous surface, so you can have them comment when they change back if you like.
{
	"\1\s[-1]\0\s[0]\e"
}